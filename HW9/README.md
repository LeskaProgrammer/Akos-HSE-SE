
# ОТЧЕТ ПО ДОМАШНЕМУ ЗАДАНИЮ №9

**Студент:** Симонов Алексей
**Группа:** 248
**Тема:** Межпроцессное взаимодействие через сигналы UNIX

---

## !!! ДОПОЛНИТЕЛЬНЫЙ ФУНКЦИОНАЛ (РЕАЛИЗАЦИЯ НА ОЦЕНКУ 10 (надеюсь)) !!!

ДЛЯ ПОЛУЧЕНИЯ МАКСИМАЛЬНОЙ ОЦЕНКИ Я РЕАЛИЗОВАЛ СЛЕДУЮЩИЕ УЛУЧШЕНИЯ:

1.  **КОНТРОЛЬ ЦЕЛОСТНОСТИ (PARITY BIT):**
    ПРОТОКОЛ ПЕРЕДАЕТ НЕ 32, А **33 БИТА**. ПОСЛЕДНИЙ БИТ — ЭТО XOR-СУММА (БИТ ЧЕТНОСТИ). ПРИЕМНИК ПРОВЕРЯЕТ ЭТОТ БИТ, И ЕСЛИ ОН НЕ СОВПАДАЕТ С РАСЧЕТНЫМ, ВЫДАЕТСЯ ОШИБКА ЦЕЛОСТНОСТИ. ЭТО ГАРАНТИРУЕТ, ЧТО ДАННЫЕ НЕ БЫЛИ ИСКАЖЕНЫ.

2.  **ЗАЩИТА ОТ ЗАВИСАНИЙ (TIMEOUTS):**
    ИСПОЛЬЗУЕТСЯ СИСТЕМНЫЙ ВЫЗОВ `sigtimedwait` ВМЕСТО БЛОКИРУЮЩЕГО `pause`. ЕСЛИ ПРИЕМНИК ЗАВИСНЕТ, ВЫЛЕТИТ ИЛИ БУДЕТ ЗАКРЫТ, ПЕРЕДАТЧИК НЕ БУДЕТ ЖДАТЬ ВЕЧНО, А КОРРЕКТНО ЗАВЕРШИТСЯ С ОШИБКОЙ ЧЕРЕЗ 3 СЕКУНДЫ.

3.  **МЕТРИКА ПРОИЗВОДИТЕЛЬНОСТИ:**
    ПРОГРАММА ЗАМЕРЯЕТ ТОЧНОЕ ВРЕМЯ (WALL-CLOCK TIME) ПЕРЕДАЧИ ДАННЫХ В СЕКУНДАХ.

---

## 1. Выполнение критериев задания

### Базовая часть (4-6 баллов):
*   [✓] **Передача данных:** Корректно передаются целые числа (`int32_t`).
*   [✓] **Сигналы:** Используются только `SIGUSR1` и `SIGUSR2`.
*   [✓] **Раздельный запуск:** Программы работают в разных терминалах, PID вводится вручную.

### Асинхронная работа (8 баллов):
*   [✓] **Надежность:** Реализован протокол с подтверждением приема каждого бита (ACK).
*   [✓] **Безопасность:** Сигналы блокируются через `sigprocmask` и принимаются через `sigtimedwait`/`sigwaitinfo`, что исключает гонки сигналов и потерю данных.

## 2. Описание реализации

Мною разработан протокол передачи данных типа "Stop-and-Wait".

### Архитектура Sender (Передатчик)
1.  Блокирует сигналы для ручного управления.
2.  **Handshake:** Отправляет сигнал приветствия и ждет ACK от приемника.
3.  Преобразует число в `uint32_t` и в цикле отправляет 32 бита.
    *   0 -> `SIGUSR1`, 1 -> `SIGUSR2`.
    *   После каждого бита ждет `SIG_ACK` (сигнал подтверждения) от приемника в течение 3 секунд.
4.  Вычисляет и отправляет 33-й **бит четности**.
5.  Отправляет `SIGINT` для завершения работы приемника.

### Архитектура Receiver (Приемник)
1.  Блокирует сигналы.
2.  Ждет первый сигнал от PID передатчика. Отвечает ACK.
3.  В цикле принимает сигналы, собирает биты в число, обновляет свой подсчет четности.
4.  На каждый принятый бит отправляет передатчику ACK.
5.  При получении 33-го бита сохраняет его для проверки.
6.  При получении `SIGINT` проверяет четность и выводит результат.

## 3. Результаты работы

**Терминал Приемника:**

    === ПРИЕМНИК [PID: 10203] ===
    Введите PID передатчика: 10204
    [Связь] Ожидание подключения...
    [Связь] Соединение установлено.
    Принимаю поток: 11111111111111110000000000000000 [Parity: 0]
    
    --- ИТОГ ---
    Принято число: -65536
    Hex: 0xFFFF0000
    Проверка целостности: [ OK ] Данные корректны.

**Терминал Передатчика:**

    === ПЕРЕДАТЧИК [PID: 10204] ===
    Введите PID приемника: 10203
    Введите число: -65536
    [Связь] Инициализация...
    [Связь] Приемник готов. Передача...
    Прогресс: [#################################] 100%
    [Parity] Контрольный бит отправлен.
    
    Успешно. Время передачи: 0.042 сек.
