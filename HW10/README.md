# Отчет по домашнему заданию № 10

**Студент:** Симонов Алексей
**Группа:** БПИ-248

### Краткое описание стека

Для выполнения задания использован язык **C++** и библиотека **POSI✔ Threads** (`pthread`).

* **Синхронизация:** Используются мьютексы (`pthread_mute✔_t`) для защиты общего буфера и условные переменные (`pthread_cond_t`) для реализации эффективного ожидания в потоке-Мониторе.
* **Архитектура:**
    * **Producers (Источники):** 100 независимых потоков, генерирующих данные.
    * **Buffer:** Очередь `std::deque` для хранения чисел.
    * **Monitor:** Главный поток, который спит в ожидании сигнала. При появлении >= 2 элементов в буфере он просыпается и создает поток-сумматор.
    * **Workers (Сумматоры):** Временные потоки, выполняющие сложение и возвращающие результат в буфер.

---

### Чек-лист критериев (Выполнено 10/10)

| № | Критерий | Статус | Примечание |
|---|---|---|---|
| 1 | Использование библиотеки POSI✔ threads | [✔] | Подключен `<pthread.h>`, используются функции `pthread_create`, `mute✔`, `cond`. |
| 2 | Асинхронные параллельные вычисления | [✔] | Источники и сумматоры работают параллельно. |
| 3 | Реализовано 100 источников информации | [✔] | Цикл запуска 100 потоков `producer_routine`. |
| 4 | Источники: числа 1-100, задержка 1-7 сек | [✔] | `rand() % 100 + 1` и `sleep(rand() % 7 + 1)`. |
| 5 | Общий буфер для хранения и обработки | [✔] | Использован `std::deque<int>` под мьютексом. |
| 6 | Поток-Монитор отслеживает поступление | [✔] | Реализован через `pthread_cond_wait`. |
| 7 | Создание сумматора при наличии пары | [✔] | Монитор извлекает 2 числа и делает `pthread_create`. |
| 8 | Сумматор: задержка 3-6 сек, возврат в буфер | [✔] | `sleep(3-6)`, результат `push_back` обратно. |
| 9 | Одновременная работа нескольких сумматоров | [✔] | Потоки сумматоров `detached` и работают независимо. |
| 10 | Подробный протокол (лог) вывода | [✔] | Логируются ID потоков, действия и состояние буфера. |

---

### ввод и вывода программы

**Ввод:**
Программа работает автономно, пользовательский ввод не требуется. Параметры (100 потоков, задержки) заданы в коде.

**вывод (консоль):**

    === ЗАПУСК СИМУЛЯЦИИ ===
    [Источник 12] Сгенерировал: 45 (сон 1с). Буфер: 1
    [Источник 5] Сгенерировал: 10 (сон 1с). Буфер: 2
    [МОНИТОР] Найдена пара (45, 10). Запуск Сумматора #1
    [Источник 99] Сгенерировал: 5 (сон 2с). Буфер: 1
    -> [Сумматор 1] Результат: 45 + 10 = 55 (время 3с). Буфер: 2
    [МОНИТОР] Найдена пара (5, 55). Запуск Сумматора #2
    ...
    [Источник 33] Сгенерировал: 1 (сон 7с). Буфер: 2
    [МОНИТОР] Найдена пара (4950, 1). Запуск Сумматора #99
    -> [Сумматор 99] Результат: 4950 + 1 = 4951 (время 4с). Буфер: 1
    === ВЫЧИСЛЕНИЯ ЗАВЕРШЕНЫ ===
    ФИНАЛЬНЫЙ РЕЗУЛЬТАТ: 4951
    [Система] Файл лога 'simulation.log' успешно записан.